---
import { Icon } from 'astro-icon/components';
import Button from './Button.astro';
type Translations = typeof import('../i18n/en').default;
type FooterContent = Translations['footer'];
interface Props {
  content?: FooterContent;
}
const { content } = Astro.props as Props;
const currentPath = Astro.url.pathname;
// Detectar el idioma actual ('en' o 'es')
const match = currentPath.match(/^\/(en|es)/);
const lang = match ? match[1] : 'en';

// Normalize paths for comparison: remove language prefix, ensure leading slash,
// and remove trailing slash (unless root). This makes active detection robust
function normalizePath(p: string | undefined) {
  if (!p) return '/';
  // remove language prefix if present
  let s = p.replace(/^\/(en|es)/, '');
  if (!s.startsWith('/')) s = '/' + s;
  if (s.length > 1 && s.endsWith('/')) s = s.slice(0, -1);
  return s;
}

const normalized = normalizePath(currentPath);
const icons = [
  {
    icon: 'facebook',
    href: '#',
  },
  {
    icon: 'linkedin',
    href: '#',
  },
  {
    icon: 'instagram',
    href: '#',
  },
  {
    icon: 'youtube',
    href: '#',
  },
];
---

<footer class="w-full bg-accent-3">
  <div
    class="bg-accent-2 rounded-t-[36px] w-full flex flex-col justify-center items-center"
  >
    <div
      class="w-full max-w-screen md:max-w-[1211px] px-6 xl:px-0 pt-[55px] flex flex-col justify-center items-center gap-9"
    >
      <div
        class="w-full flex flex-col md:flex-row justify-center md:justify-between items-center gap-10"
      >
        <div
          class="flex flex-col justify-center items-center md:items-start gap-9"
        >
          <p class="text-[46px] font-semibold leading-[117%] text-white">
            {content?.part1.title}
          </p>
          <Button
            text={content?.part1.button}
            extraBtnClass="border border-white px-6"
            textClass="text-[16px] text-white"
            iconClass=" text-white"
          />
          <div class="flex justify-center items-center gap-2">
            <p
              class="text-[12px] leading-[100%] font-normal uppercase text-white"
            >
              {content?.part1.text}
            </p>
            <div class="flex justify-center items-center gap-[15px]">
              {
                icons.map((item) => (
                  <div class="w-8 h-8 flex justify-center items-center gap-2.5 rounded-full border border-white cursor-pointer group hover:bg-accent-1  transition-all duration-200 ease-in-out">
                    <Icon
                      name={item.icon}
                      href={item.href}
                      class={'w-4 h-4 text-white'}
                    />
                  </div>
                ))
              }
            </div>
          </div>
        </div>
        <div
          class="flex justify-between md:justify-center items-center gap-0 md:gap-[87px] w-full md:w-auto"
        >
          <nav class="flex flex-col justify-center items-start gap-5">
            {
              content?.part2.nav.map((item) => {
                const itemPathWithoutHash = item.href.split('#')[0] || '/';
                const itemNormalized = normalizePath(itemPathWithoutHash);
                const isActive = normalized === itemNormalized;
                return (
                  <a
                    class={`text-[16px] leading-[150%] transition-all duration-200 ease-in-out hover:text-accent-1 ${isActive ? 'font-bold text-accent-1' : 'text-white font-light'}`}
                    href={`/${lang}${item.href}`}
                  >
                    {item.label}
                  </a>
                );
              })
            }
          </nav>
          <div class="flex flex-col justify-center items-start gap-4">
            <div class="flex justify-center items-center gap-2.5">
              <Icon name={'arroba'} class={'w-5 h-5'} />
              <div class="flex flex-col justify-center items-start gap-1">
                <p
                  class="text-[14px] font-bold leading-[100%] uppercase text-white"
                >
                  {content?.part2.info.label1}
                </p>
                <p class="text-[16px] font-light leading-[150%] text-white">
                  informes@notariaramos.pe
                </p>
              </div>
            </div>
            <div class="flex justify-center items-center gap-2.5">
              <Icon name={'call'} class={'w-5 h-5'} />
              <div class="flex flex-col justify-center items-start gap-1">
                <p
                  class="text-[14px] font-bold leading-[100%] uppercase text-white"
                >
                  {content?.part2.info.label2}
                </p>
                <p class="text-[16px] font-light leading-[150%] text-white">
                  01 2638686
                </p>
              </div>
            </div>
            <div class="flex justify-center items-center gap-2.5">
              <Icon name={'map'} class={'w-5 h-5'} />
              <div class="flex flex-col justify-center items-start gap-1">
                <p
                  class="text-[14px] font-bold leading-[100%] uppercase text-white"
                >
                  {content?.part2.info.label3}
                </p>
                <p class="text-[16px] font-light leading-[150%] text-white">
                  Avenida La Marina 1443 <br /> San Miguel, Lima - Per√∫
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div
        class="flex justify-center items-center py-[30px] border-t border-white/20 text-white w-full"
      >
        <p class="text-[16px] font-light leading-[150%]">@2025 los amecas</p>
      </div>
    </div>
    <div class="shrink-0 w-full h-[75px] relative overflow-hidden">
      <img
        src="/footer.webp"
        alt="Imagen del Footer Los Amecas"
        width="1512"
        height="79"
        class="w-full h-auto absolute inset-0 object-cover"
        loading="lazy"
        decoding="async"
      />
    </div>
  </div>
</footer>
