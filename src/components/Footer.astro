---
import { Icon } from 'astro-icon/components';
import Button from './Button.astro';
type Translations = typeof import('../i18n/en').default;
type FooterContent = Translations['footer'];
interface Props {
  content?: FooterContent;
}
const { content } = Astro.props as Props;
const currentPath = Astro.url.pathname;
// Detectar el idioma actual ('en' o 'es')
const match = currentPath.match(/^\/(en|es)/);
const lang = match ? match[1] : 'en';

// Normalize paths for comparison: remove language prefix, ensure leading slash,
// and remove trailing slash (unless root). This makes active detection robust
function normalizePath(p: string | undefined) {
  if (!p) return '/';
  // remove language prefix if present
  let s = p.replace(/^\/(en|es)/, '');
  if (!s.startsWith('/')) s = '/' + s;
  if (s.length > 1 && s.endsWith('/')) s = s.slice(0, -1);
  return s;
}

const normalized = normalizePath(currentPath);
const icons = [
  {
    icon: 'facebook',
    href: 'https://www.facebook.com/people/Taqueria-Amecas/100073312594879/?ref=_ig_profile_ac',
  },
  {
    icon: 'instagram',
    href: 'https://www.instagram.com/taqueriaameca/',
  },
  {
    icon: 'youtube',
    href: '#',
  },
  {
    icon: 'tiktok',
    href: 'https://www.tiktok.com/@taqueriaamecaoficial',
  },
];
---

<footer class="w-full bg-accent-3">
  <div
    class="bg-accent-5 rounded-t-[36px] w-full flex flex-col justify-center items-center"
  >
    <div
      class="w-full max-w-screen md:max-w-[1211px] px-6 xl:px-0 pt-[55px] flex flex-col justify-center items-center gap-9"
    >
      <div
        class="w-full flex flex-col md:flex-row justify-center md:justify-between items-center gap-10"
      >
        <div
          class="flex flex-col justify-center items-center md:items-start gap-9"
        >
          <p class="text-[46px] font-semibold leading-[117%] text-white">
            {content?.part1.title}
          </p>
          <Button
            text={content?.part1.button}
            extraBtnClass="border border-white px-6"
            textClass="text-[16px] text-white"
            iconClass=" text-white"
            href='/en/info/#contact'
          />
          <div class="flex justify-center items-center gap-2">
            <p
              class="text-[12px] leading-[100%] font-normal uppercase text-white"
            >
              {content?.part1.text}
            </p>
            <div class="flex justify-center items-center gap-[15px]">
              {
                icons.map((item) => (
                  <a class="w-8 h-8 flex justify-center items-center gap-2.5 rounded-full border border-white cursor-pointer group hover:bg-accent-1  transition-all duration-200 ease-in-out" href={item.href} target="_blank" rel="noopener noreferrer">
                    <Icon
                      name={item.icon}
                      href={item.href}
                      class={'w-4 h-4 text-white'}
                    />
                  </a>
                ))
              }
            </div>
          </div>
        </div>
        <div
          class="flex justify-between md:justify-center items-center gap-0 md:gap-[87px] w-full md:w-auto"
        >
          <nav class="flex flex-col justify-center items-start gap-5">
            {
              content?.part2.nav.map((item) => {
                const itemPathWithoutHash = item.href.split('#')[0] || '/';
                const itemNormalized = normalizePath(itemPathWithoutHash);
                const isActive = normalized === itemNormalized;
                return (
                  <a
                    class={`text-[16px] leading-[150%] transition-all duration-200 ease-in-out hover:text-accent-1 ${isActive ? 'font-bold text-accent-1' : 'text-white font-light'}`}
                    href={`/${lang}${item.href}`}
                  >
                    {item.label}
                  </a>
                );
              })
            }
          </nav>
          <div class="flex flex-col justify-center items-start gap-4">
            <div class="flex justify-center items-center gap-2.5">
              <img
                src="/arroba.svg"
                alt="Icono de Arroba"
                width="20"
                height="20"
                class="w-5 h-5"
              />
              <div class="flex flex-col justify-center items-start gap-1">
                <p
                  class="text-[14px] font-bold leading-[100%] uppercase text-white"
                >
                  {content?.part2.info.label1}
                </p>
                <a
                  class="text-[16px] font-light leading-[150%] text-white"
                  href="https://mail.google.com/mail/?view=cm&fs=1&to=losamecastaqueria@outlook.com"
                  target="_blank"
                  rel="noopener noreferrer"
                >
                  losamecastaqueria@outlook.com
                </a>
              </div>
            </div>
            <div class="flex justify-center items-center gap-2.5">
              <img
                src="/call.svg"
                alt="Icono de Arroba"
                width="20"
                height="20"
                class="w-5 h-5"
              />
              <div class="flex flex-col justify-center items-start gap-1">
                <p
                  class="text-[14px] font-bold leading-[100%] uppercase text-white"
                >
                  {content?.part2.info.label2}
                </p>
                <a
                  class="text-[16px] font-light leading-[150%] text-white"
                  href="tel:+14072031512"
                >
                  +1 (407) 203 1512
                </a>
              </div>
            </div>
            <div class="flex justify-center items-center gap-2.5">
              <img
                src="/map.svg"
                alt="Icono de Mapa"
                width="20"
                height="20"
                class="w-5 h-5"
              />
              <div class="flex flex-col justify-center items-start gap-1">
                <p
                  class="text-[14px] font-bold leading-[100%] uppercase text-white"
                >
                  {content?.part2.info.label3}
                </p>
                <p class="text-[16px] font-light leading-[150%] text-white">
                  3558 S Orange Ave, Orlando, FL <br /> 32806, United States
                </p>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div
        class="flex flex-col md:flex-row justify-center md:justify-between items-center py-[30px] border-t border-white/20 text-white w-full gap-5 md:gap-0"
      >
        <p class="text-[16px] font-light leading-[150%]">@2025 los amecas</p>
        <div class="flex justify-center items-center gap-4 md:gap-5">
          <a href="#" class="text-[14px] font-light leading-5 underline">Privacy Policy</a>
          <a href="#" class="text-[14px] font-light leading-5 underline">Terms and Conditions</a>
          <a href="#" class="text-[14px] font-light leading-5 underline">Quality Policy</a>
        </div>
      </div>
    </div>
    <div class="shrink-0 w-full h-[50px] md:h-[75px] relative overflow-hidden">
      <img
        src="/footer.webp"
        alt="Imagen del Footer Los Amecas"
        width="1512"
        height="79"
        class="absolute inset-0 w-full h-full object-cover object-bottom md:object-centerr"
        loading="lazy"
        decoding="async"
      />
    </div>
  </div>
</footer>
